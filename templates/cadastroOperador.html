<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Cadastro de Operadores</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />

  <style>
    .botao-estiloso, .botao-voltar, .botao-salvar {
      font-size: 18px;
      color: white;
      border-radius: 8px;
      box-shadow: 0 5px 15px rgba(0,0,0,0.2);
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
      border: none;
      padding: 6px 20px;
      cursor: pointer;
    }

    .botao-estiloso { background-color: #072749; }
    .botao-estiloso:hover { background-color: #0056b3; }
    .botao-voltar { background-color: #1fa53c; }
    .botao-voltar:hover { background-color: #128d2e; }
    .botao-salvar { background-color: #be0d0d; }
    .botao-salvar:hover { background-color: #ec5050; }

    .botao-estiloso::after, .botao-voltar::after, .botao-salvar::after {
      content: "";
      position: absolute;
      top: 0; left: -100%;
      width: 100%; height: 100%;
      background: rgba(255, 255, 255, 0.2);
      transform: skewX(-20deg);
      transition: left 0.5s ease;
    }

    .botao-estiloso:hover::after,
    .botao-voltar:hover::after,
    .botao-salvar:hover::after {
      left: 100%;
    }
  </style>
</head>
<body class="bg-light p-4">

  <div class="container">
    <h2 class="mb-4">Cadastro de Operadores</h2>

    <form action="/operador/" method="POST" id="formCadastroOperador" onsubmit="prepararEnvioOperador()">
      <div class="row g-3 mb-3">
        <div class="col-md-3">
          <label for="nome" class="form-label">Nome</label>
          <input type="text" class="form-control" id="nome" />
        </div>
        <div class="col-md-2">
          <label for="regiao" class="form-label">Regi√£o</label>
          <input type="text" class="form-control" id="regiao" />
        </div>
        <div class="col-md-1">
          <label for="ativo" class="form-label">Ativo</label>
          <select class="form-select" id="ativo">
            <option value=""></option>
            <option value="sim">Sim</option>
            <option value="nao">N√£o</option>
          </select>
        </div>
        <div class="col-md-2">
          <label for="area" class="form-label">√Årea</label>
          <input type="text" class="form-control" id="area" />
        </div>
        <div class="col-md-2">
          <label for="login" class="form-label">Login</label>
          <input type="text" class="form-control" id="login" />
        </div>
        <div class="col-md-2">
          <label for="senha" class="form-label">Senha</label>
          <input type="password" class="form-control" id="senha" />
        </div>
      </div>

      <div class="row g-3 mb-3">
        <div class="col-md-2">
          <label for="comissao" class="form-label">Comiss√£o (%)</label>
          <input type="number" class="form-control" id="comissao" min="0" max="100" />
        </div>
        <div class="col-md-2">
          <label for="cancelar_poule" class="form-label">Cancelar Poule</label>
          <select class="form-select" id="cancelar_poule">
            <option value=""></option>
            <option value="sim">Sim</option>
            <option value="nao">N√£o</option>
          </select>
        </div>
        <div class="col-md-2">
          <label for="exibe_comissao" class="form-label">Exibe Comiss√£o</label>
          <select class="form-select" id="exibe_comissao">
            <option value=""></option>
            <option value="sim">Sim</option>
            <option value="nao">N√£o</option>
          </select>
        </div>
        <div class="col-md-2">
          <label for="limite_venda" class="form-label">Limite Venda</label>
          <input type="number" class="form-control" id="limite_venda" min="0" />
        </div>
        <div class="col-md-2">
          <label for="tipo_limite" class="form-label">Tipo Limite</label>
          <input type="text" class="form-control" id="tipo_limite" />
        </div>
        <div class="col-md-2">
          <label for="grade" class="form-label">Grade</label>
          <input type="text" class="form-control" id="grade" />
        </div>
      </div>

      <div class="row g-3 mb-3">
        <div class="col-md-2">
          <label for="teste" class="form-label">Teste</label>
          <input type="text" class="form-control" id="teste" />
        </div>
        <div class="col-md-2">
          <label for="comissao_retida" class="form-label">Comiss√£o Retida</label>
          <input type="text" class="form-control" id="comissao_retida" />
        </div>
        <div class="col-md-3">
          <label for="serial_maquina" class="form-label">Serial M√°quina</label>
          <input type="text" class="form-control" id="serial_maquina" />
        </div>
      </div>

      <div class="mb-3 d-flex gap-2">
        <button type="button" class="botao-estiloso" onclick="adicionarLinhaOperador()">Adicionar</button>
        <button type="submit" class="botao-voltar">Salvar</button>
        <a href="principal.html" class="btn botao-salvar">Sair</a>
      </div>

      <!-- Inputs ocultos para enviar dados da tabela -->
      <div id="hiddenFieldsOperador"></div>
    </form>

    <table class="table table-bordered table-hover bg-white" id="tabelaOperador">
      <thead class="table-success">
        <tr>
          <th>Nome</th>
          <th>Regi√£o</th>
          <th>Ativo</th>
          <th>√Årea</th>
          <th>Login</th>
          <th>Senha</th>
          <th>Comiss√£o</th>
          <th>Cancelar Poule</th>
          <th>Exibe Comiss√£o</th>
          <th>Limite Venda</th>
          <th>Tipo Limite</th>
          <th>Grade</th>
          <th>Teste</th>
          <th>Comiss√£o Retida</th>
          <th>Serial M√°quina</th>
          <th>A√ß√µes</th>
        </tr>
      </thead>
      <tbody>
  {% for operador in operadores %}
    <tr>
      <td>{{ operador.nome }}</td>
      <td>{{ operador.regiao }}</td>
      <td>{{ operador.ativo }}</td>
      <td>{{ operador.area }}</td>
      <td>{{ operador.login }}</td>
      <td>{{ operador.senha }}</td>
      <td>{{ operador.comissao }}</td>
      <td>{{ operador.cancelar_poule }}</td>
      <td>{{ operador.exibe_comissao }}</td>
      <td>{{ operador.limite_venda }}</td>
      <td>{{ operador.tipo_limite }}</td>
      <td>{{ operador.grade }}</td>
      <td>{{ operador.teste }}</td>
      <td>{{ operador.comissao_retida }}</td>
      <td>{{ operador.serial_maquina }}</td>
      <td>
          <button type="button" class="botao-estiloso">‚úèÔ∏è Editar</button>
          <button type="button" class="botao-salvar">üóëÔ∏è Excluir</button>
      </td>
    </tr>
  {% endfor %}
</tbody>
    </table>
  </div>

<script>
  function adicionarLinhaOperador() {
    // Pega os valores dos inputs
    const nome = document.getElementById('nome').value.trim();
    const regiao = document.getElementById('regiao').value.trim();
    const ativo = document.getElementById('ativo').value;
    const area = document.getElementById('area').value.trim();
    const login = document.getElementById('login').value.trim();
    const senha = document.getElementById('senha').value.trim();
    const comissao = document.getElementById('comissao').value;
    const cancelar_poule = document.getElementById('cancelar_poule').value;
    const exibe_comissao = document.getElementById('exibe_comissao').value;
    const limite_venda = document.getElementById('limite_venda').value;
    const tipo_limite = document.getElementById('tipo_limite').value.trim();
    const grade = document.getElementById('grade').value.trim();
    const teste = document.getElementById('teste').value.trim();
    const comissao_retida = document.getElementById('comissao_retida').value.trim();
    const serial_maquina = document.getElementById('serial_maquina').value.trim();

    // Valida√ß√£o simples
    if (!nome || !regiao || !ativo || !area || !login || !senha) {
      alert('Preencha os campos obrigat√≥rios: Nome, Regi√£o, Ativo, √Årea, Login e Senha.');
      return;
    }

    // Adiciona linha na tabela
    const tbody = document.querySelector('#tabelaOperador tbody');
    const novaLinha = tbody.insertRow();

    novaLinha.insertCell(0).innerText = nome;
    novaLinha.insertCell(1).innerText = regiao;
    novaLinha.insertCell(2).innerText = ativo;
    novaLinha.insertCell(3).innerText = area;
    novaLinha.insertCell(4).innerText = login;
    novaLinha.insertCell(5).innerText = senha;
    novaLinha.insertCell(6).innerText = comissao || '';
    novaLinha.insertCell(7).innerText = cancelar_poule || '';
    novaLinha.insertCell(8).innerText = exibe_comissao || '';
    novaLinha.insertCell(9).innerText = limite_venda || '';
    novaLinha.insertCell(10).innerText = tipo_limite || '';
    novaLinha.insertCell(11).innerText = grade || '';
    novaLinha.insertCell(12).innerText = teste || '';
    novaLinha.insertCell(13).innerText = comissao_retida || '';
    novaLinha.insertCell(14).innerText = serial_maquina || '';

    // Limpa os campos
    document.getElementById('formCadastroOperador').reset();
  }

  function prepararEnvioOperador() {
    const tbody = document.querySelector('#tabelaOperador tbody');
    const hiddenFieldsDiv = document.getElementById('hiddenFieldsOperador');
    hiddenFieldsDiv.innerHTML = '';

    const campos = [
      'nome', 'regiao', 'ativo', 'area', 'login', 'senha',
      'comissao', 'cancelar_poule', 'exibe_comissao', 'limite_venda',
      'tipo_limite', 'grade', 'teste', 'comissao_retida', 'serial_maquina'
    ];

    Array.from(tbody.rows).forEach(row => {
      campos.forEach((campo, index) => {
        const input = document.createElement('input');
        input.type = 'hidden';
        input.name = campo + '[]';  // array para receber v√°rios operadores
        input.value = row.cells[index].textContent.trim();
        hiddenFieldsDiv.appendChild(input);
      });
    });
  }
</script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
